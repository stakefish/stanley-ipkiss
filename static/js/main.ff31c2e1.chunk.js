(this["webpackJsonpstanley-ipkiss"]=this["webpackJsonpstanley-ipkiss"]||[]).push([[0],{56:function(e,t){},57:function(e,t){},58:function(e,t){},71:function(e,t,n){"use strict";n.r(t);var c,a,r,s,i=n(20),o=n.n(i),u=n(2),l=n.n(u),j=n(3),b=n.n(j),d=n(11),O=n(8),f=n(14),v=n(76),x=n(17),h=n(34),p=n.n(h),m=n(78),k=n(42),g=180/Math.PI,y=n(4),w=l.a.createContext({}),C=function(e){var t=e.children,n=Object(u.useRef)(null),c=Object(u.useRef)(null),a=Object(u.useState)(),r=Object(O.a)(a,2),s=r[0],i=r[1],o=Object(u.useState)(0),l=Object(O.a)(o,2),j=l[0],f=l[1],v=Object(u.useState)([]),h=Object(O.a)(v,2),g=h[0],C=h[1],R=Object(u.useState)([]),S=Object(O.a)(R,2),D=S[0],F=S[1],W=Object(u.useState)([]),E=Object(O.a)(W,2),L=E[0],P=E[1],U=Object(u.useState)([]),H=Object(O.a)(U,2),I=H[0],M=H[1],A=Object(u.useCallback)((function(e,t,n){C([].concat(Object(x.a)(g),[e])),F([].concat(Object(x.a)(D),[t])),P([].concat(Object(x.a)(L),[1])),M([].concat(Object(x.a)(I),[n]))}),[g,I,D,L]),J=Object(u.useCallback)((function(e){F(Object(m.a)(j,e))}),[j,D]),N=Object(u.useCallback)((function(e){M(Object(m.a)(j,e))}),[j,I]),z=Object(u.useCallback)((function(e){P(Object(m.a)(j,e))}),[j,L]),B=Object(u.useCallback)((function(e){f(e)}),[j]),q=Object(u.useCallback)(Object(d.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===n||void 0===n?void 0:n.current)||!(null===c||void 0===c?void 0:c.current)){e.next=11;break}return e.prev=1,e.next=4,Object(k.a)(c.current,{canvasWidth:n.current.naturalWidth,canvasHeight:n.current.naturalHeight});case 4:t=e.sent,p()(t,"mask.png"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),[j]),G=Object(u.useCallback)((function(){C([]),F([]),M([]),f(0)}),[j]),K=Object(u.useCallback)((function(e){var t=Object(O.a)(e,1)[0];G(),i(URL.createObjectURL(t))}),[s]);return Object(y.jsx)(w.Provider,{value:{faceRef:n,artboardRef:c,file:s,masks:g,angles:D,scales:L,coordinates:I,rotate:J,scale:z,active:j,move:N,select:B,clear:G,create:A,save:q,drop:K},children:t})},R=w,S=function(){return Object(u.useContext)(R)},D=n(12),F=n(77),W=n(41),E=function(e){var t=e.children;return Object(y.jsx)(D.a,{theme:{colors:{},fontSize:{},fontWeight:{}},children:Object(y.jsx)(F.a,{backend:W.a,children:Object(y.jsx)(C,{children:t})})})},L=n(13),P=(n(64),n(43)),U=n(9),H=function(){var e,t,n=S(),c=n.angles,a=n.scales,r=n.active,s=n.rotate,i=n.scale,o=n.save,u=n.drop,l=Object(P.a)({accept:"image/*",onDrop:u}),j=l.getRootProps,b=l.getInputProps,d=l.isDragActive,O=null!==(e=null===a||void 0===a?void 0:a[r])&&void 0!==e?e:1,f=null!==(t=null===c||void 0===c?void 0:c[r])&&void 0!==t?t:0;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("button",{onClick:o,children:"Download"}),Object(y.jsxs)("div",Object(L.a)(Object(L.a)({},j()),{},{children:[Object(y.jsx)("input",Object(L.a)({},b())),d?Object(y.jsx)("p",{children:"Drop the files here ..."}):Object(y.jsx)("p",{children:"Drag 'n' drop some files here, or click to select files"})]})),Object(y.jsxs)("i",{children:["Angle: ",f]}),Object(y.jsx)(U.b,{value:f,min:-180,max:180,onChange:s,children:Object(y.jsxs)(U.e,{children:[Object(y.jsx)(U.d,{}),Object(y.jsx)(U.a,{}),Object(y.jsx)(U.c,{value:f})]})}),Object(y.jsxs)("i",{children:["Scale: ",O]}),Object(y.jsx)(U.b,{value:O,min:0,max:2,step:.01,onChange:i,children:Object(y.jsxs)(U.e,{children:[Object(y.jsx)(U.d,{}),Object(y.jsx)(U.a,{}),Object(y.jsx)(U.c,{value:O})]})})]})},I=n(40),M=n.n(I),A=function(e,t){var n=t.y-e.y,c=t.x-e.x;return Math.atan2(n,c)*g},J=function(e){if(!Object(v.a)(e)){var t=e.reduce((function(e,t){return{x:e.x+t.x,y:e.y+t.y}}),{x:0,y:0}),n=t.x,c=t.y;return{x:n/e.length,y:c/e.length}}},N=function(){var e=Object(d.a)(b.a.mark((function e(t,n){var c,a,r,s,i,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new f.a,e.next=3,Object(f.b)(t,c).withFaceLandmarks();case 3:if(a=e.sent,r=J(null===a||void 0===a?void 0:a.landmarks.getNose()),s=J(null===a||void 0===a?void 0:a.landmarks.getLeftEye()),i=J(null===a||void 0===a?void 0:a.landmarks.getRightEye()),o=n.offsetWidth/t.naturalWidth,!(s&&i&&r)){e.next=10;break}return e.abrupt("return",{position:{x:r.x*o,y:Math.min(s.y,i.y)*o},rotation:A(s,i)});case 10:return e.abrupt("return",{position:{x:n.offsetWidth/2,y:n.offsetHeight/2},rotation:0});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=n(16),B=D.b.img(c||(c=Object(z.a)(["\n  cursor: move;\n  display: block;\n  user-drag: none;\n  transform: ",";\n"])),(function(e){return"rotate(".concat(e.angle,"deg) scale(").concat(e.scale,")")})),q=D.b.div(a||(a=Object(z.a)(["\n  max-width: 500px;\n  overflow: hidden;\n  user-select: none;\n  position: relative;\n"]))),G=D.b.div(r||(r=Object(z.a)(["\n  position: absolute;\n"]))),K=D.b.img(s||(s=Object(z.a)(["\n  width: 100%;\n  display: block;\n  user-drag: none;\n"]))),Q=function(){var e=S(),t=e.artboardRef,n=e.faceRef,c=e.file,a=e.masks,r=e.scales,s=e.angles,i=e.coordinates,o=e.create,l=e.select,j=e.move,O=Object(u.useCallback)(Object(d.a)(b.a.mark((function e(){var c,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===n||void 0===n?void 0:n.current)||!(null===t||void 0===t?void 0:t.current)){e.next=7;break}return e.next=3,N(n.current,t.current);case 3:c=e.sent,a=c.rotation,r=c.position,o("mask.png",a,r);case 7:case"end":return e.stop()}}),e)}))),[c,n,t]),f={x:-144,y:-65};return Object(u.useEffect)((function(){O()}),[c,n]),Object(y.jsxs)(q,{ref:t,children:[null===a||void 0===a?void 0:a.map((function(e,t){return Object(y.jsx)(M.a,{handle:"img",position:null===i||void 0===i?void 0:i[t],positionOffset:f,onStop:function(e,t){return j(t)},children:Object(y.jsx)(G,{children:Object(y.jsx)(B,{width:288,height:130,src:e,angle:s[t],scale:r[t],onClick:function(){return l(t)}})},t)},t)})),c?Object(y.jsx)(K,{src:c,ref:n}):null]})},T=function(){var e=function(){var e=Object(u.useState)(),t=Object(O.a)(e,2),n=t[0],c=t[1],a=function(){var e=Object(d.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([f.c.tinyFaceDetector.loadFromUri("models"),f.c.faceLandmark68Net.loadFromUri("models")]);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),c(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(u.useEffect)((function(){a()}),[]),{ready:Object(v.a)(n),error:n}}(),t=e.ready,n=e.error;return Object(y.jsxs)(E,{children:[t?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(H,{}),Object(y.jsx)(Q,{})]}):null,n?Object(y.jsx)("span",{children:"aw, snap!"}):null]})};o.a.render(Object(y.jsx)(T,{}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.ff31c2e1.chunk.js.map